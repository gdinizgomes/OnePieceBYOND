<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; user-select: none; font-family: 'Segoe UI', sans-serif; }
        #ui-layer { position: absolute; width: 100%; height: 100%; pointer-events: none; }
        .char-info { position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.6); padding: 15px; border-radius: 8px; color: white; border: 2px solid #d4af37; }
        .hp-bar { width: 100%; height: 100%; background: #e74c3c; transition: width 0.2s; }
        .bar-container { width: 200px; height: 10px; background: #333; margin-top: 5px; overflow: hidden; }
        #combat-log { position: absolute; bottom: 20px; right: 20px; width: 300px; height: 150px; background: rgba(0,0,0,0.5); color: #fff; font-size: 12px; overflow-y: auto; padding: 10px; border-radius: 5px; font-family: monospace; pointer-events: auto; }
        .log-hit { color: #e74c3c; font-weight: bold; } 
        .log-miss { color: #95a5a6; } 
        #notif-area { position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%); text-align: center; }
        .toast { background: rgba(0,0,0,0.8); color: white; padding: 10px 20px; border-radius: 20px; margin-top: 5px; animation: fadeout 3s forwards; }
        @keyframes fadeout { 0% { opacity: 1; } 80% { opacity: 1; } 100% { opacity: 0; } }
        .name-label { position: absolute; color: white; background: rgba(0,0,0,0.5); padding: 2px 5px; border-radius: 4px; font-size: 10px; pointer-events: none; text-shadow: 1px 1px 0 #000; display: none; }
    </style>
    
    <script>
        const BYOND_REF = "{{BYOND_REF}}";
        window.onerror = function(message, source, lineno, colno, error) {
            let errorBox = document.getElementById('error-debug');
            if (!errorBox) {
                errorBox = document.createElement('div');
                errorBox.id = 'error-debug';
                errorBox.style.position = 'fixed';
                errorBox.style.top = '0';
                errorBox.style.left = '0';
                errorBox.style.width = '100%';
                errorBox.style.background = 'red';
                errorBox.style.color = 'white';
                errorBox.style.zIndex = '9999';
                errorBox.style.padding = '10px';
                errorBox.style.fontFamily = 'monospace';
                document.body.appendChild(errorBox);
            }
            errorBox.innerHTML += "ERRO: " + message + " em " + source + ":" + lineno + "<br>";
        };
    </script>
</head>
<body>
    <div id="ui-layer">
        <div class="char-info">
            <div id="name-display" style="font-size: 18px; font-weight: bold;">Loading...</div>
            <div style="font-size: 12px; color: #aaa;">Lvl <span id="lvl-display">0</span></div>
            <div class="bar-container"><div id="hp-bar-fill" class="hp-bar"></div></div>
            <div style="margin-top:5px; color:#f1c40f">ðŸ’° <span id="gold-display">0</span> Berries</div>
        </div>
        <div id="notif-area"></div>
        <div id="combat-log">System: Multiplayer Core Active.<br></div>
        <div id="labels-container"></div>
    </div>

    <script src="definitions.js"></script>
    <script src="factory.js"></script>
    <script src="engine.js"></script> 
    <script src="game.js"></script>
</body>
</html>